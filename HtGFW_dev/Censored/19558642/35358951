19558642
article
35358951
https://zhuanlan.zhihu.com/p/35358951
b1eed
dede(织梦)后台getshell新思路【过WAF】

本文由作者首发i春秋论坛，转载请声明出处。最近一直都在瞎研究一些东西，没空写文章（其实是懒）。。。。 蛋总不要怪我啊。。。0X01这个缺陷其实是在一次渗透中发现的，应该算是织梦的漏洞（不知道算不算0day）这个漏洞算是任意文件上传漏洞也可能很多大佬都知道，但是没有发出来，而且这个漏洞可以说是通杀织梦所有版本的但是要进后台才行，有点鸡肋，但是如果组合起来利用的话还是不错的。这个漏洞对于大佬来说不算什么，希望不要有版权帝说是xxx原创的。0x02本漏洞可以利用的环境1.存在WTS-WAF(或者其他WAF如安全狗，D盾)2.dede后台无文件管理器（安装不了文件管理器）3.有文件管理器但上传不了文件0x03开始讲解如何利用everybody，put your hands up。首先官网下载最新源码然后我安装在我的虚拟机上，访问可以看到是安装了文件管理器的，我们试试上传一个phpshell可以看到被拦截了没关系，下面是重点。 没错 你没有听错 就是“下面”在生成里的HTML更新----->更新主页HTML首先，把马子改成.html后缀然后上传到模板文件下，这个其实无所谓上传到哪然后选择主页模板选择刚才上传的html马子然后把主页位置改成xx.php 相当于在根目录生成xx.php其他后缀也ok   比如上传lcx.exe  改成lcx.html  然后   主页位置为lcx.exe相当于变形还原的过程，可以上传任意文件路径可以根据目标具体位置来改也可以直接上传到根目录最后成功上传了，附一张图