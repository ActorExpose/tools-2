19554927
article
35441805
https://zhuanlan.zhihu.com/p/35441805
马小帅
托WiFi万能钥匙的福，在中国有 96% 的路由器假装有密码

如果你最近留意，可能会在朋友圈见到这样的标题：央视都曝光了！WiFi 万能钥匙盗取用户网络密码，快来看看吧！没错，这次真的是被央视《经济半小时》报道了，其实关于 WiFi 钥匙共享用户密码的争议从来就不是什么新鲜事，包括这次被工信部点名，提到的无非还是过去的那些一直存在着的安全隐患。看，几年前就有此类报道，这并不是什么新闻，然而呢？如今是 2018 年，这款从诞生之初就争议缠身的产品现在已位列 App 活跃榜第三！WiFi 万能钥匙的装机量早就不是昔日可比，想想这是多么大的体量？这些年来，WiFi 万能钥匙的装机量不断刷新纪录，而带有 WiFi 功能的无线路由器早已飞入寻常百姓家。 从 WiFi 万能钥匙的工作原理可知，WiFi 路由器设备越多，WiFi 万能钥匙理论上能“破解”的 WiFi 密码就越多，就会有越多的用户去使用，被分享的 WiFi 密码就越多，从而形成正向循环。对于 WiFi 万能钥匙产品方来说，他们获得了大量用户。而对于我们用户来说，获得了大批“裸奔”在外的 WiFi 路由器。也许你会觉得黑哥在危言耸听，那我们今天就实战演练下，无需任何黑客工具，只需要 WiFi 万能钥匙加上微信扫一扫功能，能对一台共享过 WiFi 密码的路由器做些什么？黑哥在家打开 WiFi 万能钥匙扫描，发现周边就有 4 个邻居的热点可以直接连接，毫无疑问，他们的密码早就存在云端密码库了。选一个信号好的尝试连接，没问题，很快就能连上。这时候你在手机端进入无线网络热点页面，就会看到这个热点已经保存下来，下次就可以直接登录了。注意，重点来了——如果你是安卓手机，就能查看到该热点已经以二维码的形式保存到手机上。对于一个二维码？难道不是下意识地用微信扫一扫吗？好，我们把二维码截图存在相册，打开微信扫一扫，看看会发生什么？就是这么简单，这个 WiFi 热点的明文密码已经被我们获取，并且还有意外收获，邻居家的手机号。。。还记得刚才我们获取到的 IP 地址 192.168.0.105 吗，来试试这个网段的网关默认地址，也就是路由器的默认地址 192.168.0.1， 我们在手机浏览器输入上述地址访问，也就打开了邻居家路由器的管理页面。你们应该知道，路由器的初始密码一般都是常见的 “admin”，尝试了一下，果然顺利登陆。。。现在，我已经获取到了邻居家路由器的全部管理权限，而这些操作对任何一个小白来说都毫无难度。当然也是黑哥运气好，用初始密码就直接成功登陆。如果我愿意，我可以对这台路由器为所欲为。虽然黑哥没有太多的黑客技术，但对邻居的网络限个速，改个密码之类的还是绰绰有余。这简直就像一位玉体横陈的美女躺在你面前，没有一点点防备。还好黑哥坐怀不乱，看了下胸前的红领巾，悄悄关上门退了出来。也许你会说，靠初始密码登录路由器完全是靠运气。而事实上，未修改初始密码的，或者管理密码和 WiFi 设为同样密码的，而这样的用户绝不在少数。据金山毒霸安全中心发布的《2014年上半年无线路由器及WiFi安全研究报告》数据显示：高达 60% 的网民使用默认密码登录路由器后台，如admin、root 等，大约 36% 的网民使用的是弱密码，一般为有规律的键位分布或数字字母序列，比如“12345678”、“aaaaaaaa”等。也就是说，在中国，总计有 96% 的路由器密码几乎形同虚设。这样的比例，还算是运气吗？即使是用户修改过初始管理密码，只要有个靠谱的密码字典本，有台配置不错的电脑，那些可能在你看来已经设置得连自己都记不住的密码，在暴力破解面前，只有一个字：跪！不要以为暴力破解会花很长时间，来看看这张 2006 年发布的表格——破解一个最常见的 8 位数字密码在 2006 年需要 348 分钟，那么在 2018 年需要多长时间呢？只需 0.4 秒钟！这是由国际知名网络完全机构 SplashData 在 2017 年 12 月公布的最新数据。黑哥这里还提供一个网站，专用于测试你的密码被一台普通配置的电脑攻破需要多长时间。我测试了一个 8 位纯数字密码，显示结果如下——经谷歌翻译过的网站截图可见测试结果还是具有一定参考价值的。这个站点的源代码和官方的 HSIMP jQuery 插件可以在 GitHub 上找到，并且在输入测试时是脱机页面，如果你还是不够放心，大可以断网进行测试。对这个网站感兴趣的同学可以关注公众号wldxh8后在对话框回复 0408 获取网址。现在你知道了你的密码到底有多不安全了吧？好，我们继续。那么，当一个训练有素的黑客面对一台已经共享 WiFi 密码的路由器，他能干些什么？知乎用户 @evi1m0 写了一篇在攻破隔壁女神家的路由器之后的故事。他不仅通过将个性化域名地址和获取到信息加以组合，从而获取到了女神的微博、微信、QQ、手机号、照片、各种社交资料。图片来源：知乎日报图片来源：知乎日报通过数据监听和劫持，还可以用女神的微博账号发步微博，甚至远程控制女神家的电视盒子播放爱情动作片。。。图片来源：知乎日报事实上，由于 WiFi 网络的开放性和基于明文的网络协议，从 TCP/IP 到 HTTP 都是明文数据，这意味着数据很容易被“监听”，也很容易被“伪造”。监听的危害主要体现在隐私的安全上—— “对方登陆录何网站，我都能同时登入。其一举一动，我全部能看到。”刘彦硕（知乎网友 Evi1m0）告诉记者，虽然无法看到对方的账号、密码，但是他能劫持已登录的账户。（来源：重庆晚报）然而，其中的风险远不止于此， 数据“伪造”的危害更可怕。通过一台已经被攻破的路由器上网，购物或者登陆网银，你虽然输入的是官网地址，黑客可以通过 ARP 欺骗或 DNS 欺骗，将网页跳转到假支付宝或假银行网站，诱导你下载病毒木马，严重威胁到我们的财产安全。 所以，在一台裸奔的路由器上网，不只是你的照片、小电影有危险，你的支付宝、网银都岌岌可危。而这一切，对于那些别有用心的人来说，真的不是能不能的问题，只是想不想的问题。 当然，造成这些路由器假装有密码的锅不应该让 WiFi 万能钥匙全部来背，毕竟用户安全意识不强也是主要原因。但，如果没有 WiFi 万能钥匙共享的这些密码，将会大大降低路由器被“蹭网”的几率，从物理上无法连接 WiFi，又谈何攻破路由器呢？所以问题又来了，说到底还得靠自己，到底如何提高自家路由器的安全性呢？ 1、不要使用 WiFi 万能钥匙类工具，如果一定要用，务必要检查，确保自家的 WiFi 密码不被分享，若已被分享，要第一时间修改密码并向万能钥匙反馈申请取消分享。 2、路由器管理网页登录账户、密码，不要使用默认的 admin，可改为字母加数字的高强度密码；3、打开路由器的“访客模式” 若路由器支持该功能，务必打开，它可以设定供访客接入的热点和密码，访客接入后只能通过无线网络来访问 Internet 而不能访问局域网，从而保证了局域网用户的网络安全。4、WIFI 密码选择 WPA2 加密认证方式，密码长度要在 10 位以上，最好是大小写字母、数字、特殊符号的组合，这样会大大提高黑客破解密码蹭网的难度（虽然去年也已爆出被攻破）。5、隐藏 SSID /关闭广播 无线设备在搜索周围 WiFi 网络时将再也看不到你家的无线网络，连接时需要重新手动输入 SSID 和密码。6、绑定指定设备的 MAC 地址，进入“无线设置→无线 MAC 地址过滤”，过滤规则选择“允许”，然后通过“添加新条目”的方式，将允许接入无线网络的 MAC 地址添加到列表中，最后再点击“启用过滤”。7、修改路由器的默认后台管理地址，比如将默认的“192.168.1.1”修改为“192.168.10.1”。8、手动设置静态 IP 并关闭 DHCP。如果需要接入路由器的无线设备较多，可保留 DHCP，按照 MAC 地址分配 IP 。9、在设备中安装具有 ARP 局域网防护功能的安全软件，防止被黑客蹭网劫持。10、及时查询路由器官网并更新路由器固件版本，封闭路由器“后门”。11、最后，不要主动轻易告诉别人你的 WiFi 密码，别忘了《头号玩家》的 boss 是怎么挂的。虽然花了两天时间，查了大量资料写了这篇文章，然而然并卵，安全意识真正强的玩家早就做好了防范措施，而大部分用户看完这篇，最多也就是“哇，这么可怕”——“我去，这么麻烦，还是算了吧”嗯，所以说，百度李厂长的那句“中国人对隐私问题没有那么敏感，很多情况下他们是愿意用隐私交换便捷性。”真的说错了吗？我不觉得。本文在网罗灯下黑知乎专栏及同名微信公众号（wldxh8） 同步更新，觉得自己不是个正常人，想玩点和别人不一样的软件，来这里就对了！