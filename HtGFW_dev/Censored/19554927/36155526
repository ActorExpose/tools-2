19554927
article
36155526
https://zhuanlan.zhihu.com/p/36155526
W-Pwn
黑客研发“万能钥匙”，开锁五星级酒店

2003年，芬兰安全研究员Tomi Tuominen在柏林参加一个安全会议时，他的朋友装有敏感数据的笔记本电脑从旅馆房间中被偷走。这起盗窃案一直是一个谜：亚历山大广场Radisson高档酒店的工作人员没有嫌疑，门也没有暴力进入的迹象，门卡锁的电子记录——Vingcard公司生产的RFID读卡器——也没有记录到异常。Tuominen和他在F-Secure安全公司的同事Timo Hirvonen一直没有放弃对这一“悬案”的研究。他们认为Vingcard锁中存在着一个漏洞，可能会让黑客开发出某种“万能钥匙”，借此进入房间。十五年后，他们终于证明了这一点。“万能钥匙”本周在迈阿密召开的“安全渗透”（Infiltrate）会议上，Tuominen和Hirvonen展示了他们开发的技术，不是简单地克隆Vingcard Vision锁使用的钥匙卡RFID代码，而是创造了一个可以打开酒店任何房间的“万能钥匙”。他们只需要：价值300美元的Proxmark RFID卡片读写工具目标酒店过期钥匙卡俩人15年来对Vingcard电子写入代码的开-关分析而开发的一组加密技巧就可以快速制造酒店的“万能钥匙”。使用该手持Proxmark设备循环查看酒店房间锁上的所有剩余可能代码，并在大约20次尝试中识别出正确的代码，然后将该主代码写入卡片中，黑客可以随时随地漫游在任何房间中。整个过程大约需要一分钟。研究人员还发布了一个视频，展示了他们的攻击过程，他们表示可以使用Proxmark工具访问酒店电梯上的受限楼层：    https://www.zhihu.com/video/972890033832873984   影响的酒店范围接下来让我们来看看此事的主角Vingcard电子锁。VingCard专注旅游业安保及电子门锁发展业务，其母公司ASSA ABLOY是现今世界最大的五金制造商，总部位于瑞典，集团品牌遍布全世界120多个国家，旗下拥有三十二个子公司。自1864年开始造锁，VingCard迄今已有百余年历史。1967年发明出的世界第一把卡片锁更是改写了历史,变革了整个行业。今天VingCard已有超过五百多万把锁在全世界160多个国家和地区使用。在全世界的酒店电子门锁市场中，VingCard拥有约65%的市场占有率；其中包括主要的五星级酒店，例如Intercontinental（洲际）、Hyatt（凯悦）、Radisson（丽笙）、Sheraton（喜来登）等。所以，此次F-Secure公司曝出的漏洞影响非常广泛。不过这两名研究人员也表示，他们的攻击只适用于Vingcard的上一代Vision锁，而不是该公司新的Vision line产品。但他们估计，它仍然会影响全球160多个国家的140,000家酒店。Vingcard的瑞典母公司Assa Abloy私下向两名研究人员承认，这个问题影响了数百万锁。（不过在Assa Abloy公司的公开表示中，易受攻击的锁的总数仅有50万到100万）。Tuominen和Hirvonen在一年前已经隐秘地、负责任地告知了Assa Abloy公司他们发现的漏洞。该公司在今年2月份发布了一个软件安全更新，官网上可以下载。但由于Vingcard的锁没有互联网连接，该软件必须由技术人员手动安装。“很有可能并非所有的酒店都已经解决了这个问题，”Tuominen说。在WIRED杂志的电话采访中，Assa Abloy公司的酒店业务部门负责人Christophe Sut淡化了酒店客人面临的风险，并指出F-Secure的研究人员花了近12年的逆向工程和专业知识才开发出了他们的“黑客钥匙”，这对其他不法分子来说是不容易的。他也敦促所有使用Vingcard Vision锁的酒店及时升级补丁。“这应该成为一种新习惯。如果你有软件，你需要随时升级它。我们升级手机和电脑，现在还需要升级锁。”其他电子锁漏洞由于害怕帮助窃贼或间谍进入房间，Tuominen和Hirvonen并未完全公布Vingcard锁的漏洞细节。相比之下，六年前，一位安全研究人员在网上发布了广泛使用的Onity密钥卡锁中一个明显漏洞的全部代码。这导致了一场跨国盗窃狂潮，多达100个酒店房间遭受袭击。但是，又回到本文开始提到的2003年“酒店悬案”，是否在那时已经有不法分子掌握了Vingcard锁的漏洞了呢？F-Secure的研究人员承认，他们不知道此类Vinguard攻击是否发生在现实世界中。这个可能性非常高，因为像美国的LSI这种公司，就为执法机构提供“开锁”的培训，教学中使用的就是Vingcard的产品。F-Secure的研究人员也指出，2010年在迪拜酒店遇刺身亡的巴勒斯坦哈马斯高级官员被广泛认为是由以色列情报机构摩萨德（Mossad）执行的。在该案中，刺客似乎使用了Vingcard锁中的漏洞进入目标房间，尽管当时该锁需要重新编程。但对于盛产变态黑客的以色列来说，“摩萨德有能力做这样的事情并不奇怪。”再回到国内的酒店，知乎上出现了不少类似的问题：“住酒店时，半夜有人敲门并在门口发出动门锁的声音，该怎样做？”https://www.zhihu.com/question/54874491酒店电子锁中存在漏洞已经是被证明的事情，高档酒店中的Vingcard锁破解或许还需要花较长的时间，但如果是普通酒店的电子锁呢？因此建议住酒店时贵重物品最好随身携带，晚上扣上安全扣，也不妨学学知乎上这个的机智答案：入门级小偷对一般门栓是秒开，但如果你简单加一个纸球，即使是技术性小偷，也会让他怀疑人生。【推荐阅读】iPhone X要凉了吗？为什么秃头的总是王子？ 任天堂Switch出现破解漏洞Nvidia又来放大招！最新AI图像修补术，绝对秒杀PS！ 如今再用银针试毒，可行吗？ 欢迎关注我们：@W-Pwn