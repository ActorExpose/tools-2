19638541
article
34897282
https://zhuanlan.zhihu.com/p/34897282
DeepWeaver
室友不敢深夜打游戏篇二：如何用python-scapy进行arp欺骗

一些同学告诉我说arp欺骗比起普通的icmp攻击要厉害很多，所以今天我做了一篇arp欺骗的教程。声明：本教程只能用于攻击自己的手机，电脑，顶多恶搞恶搞室友。弄坏了校网被喝茶处分劝退本人一概不负责！！！:D在进行ARP欺骗的实验之前，我们有必要了解下ARP和ARP欺骗的原理。ARP和ARP欺骗原理小明(mmp怎么又是我!?)生活在一个民风淳朴的小镇，这个镇上的每个人都有唯一的IP，而每个人都有一幢或者几幢房子，每幢房子可以用其邮政编码唯一确定(假设），总之，如果你想给小明或者小红或者小华写信，只知道对方的名字是不够的，你还需要知道小明家的邮编(MAC address)，可能小明房产太多，指定了某套房专门收信，所以每次你想写信给小明，都需要询问小明的住处。来看这篇文章的应该是对计算机网络有一定基础的，我就不贴网上一本正经的概念了，简单来说arp的本质就是，你在知道你要给某个ip送包裹，但是你不知道对方的MAC地址，于是你就向内网中广播：谁有xxx的mac address？比如我们打开wireshark，搜索arp可以看到当前正在进行的arp通信，我的ip称之为57，我想知道146的mac地址，于是我广播道“谁有146？告诉57（我）”，不一会cisco收到了我的询问，他知道问题的答案,于是告诉我说“146在xx:xx:xx:xx:xx:xx(mac addr)反之，内网中有个叫oneplus的家伙（我们称之为91），问道”谁知道57（也就是我）住哪？告诉91“，我收到了他或她或它的询问，心想：看来这里有个傻帽知道我是谁但不知道我住哪。于是回答道“57（我）的mac 地址是xxxxxxxxxx”总之，内网的一切就这样很顺利进行着，直到有人动起了歪脑筋。接下来我们来瞧瞧arp欺骗是怎么一回事。在这个镇上有一家邮局(网关)，每个人的信都需要通过它才能发送到世界各地。而小明是邮局的常客了，因为他总是要和心上人小红通信，而每次信件都要通过当地唯一的这家邮局。你也住在这个镇上，愚人节那天，你打算搞点恶作剧。通常可以把ARP欺骗攻击分为如下两种主机型ARP欺骗：欺骗者主机冒充网关设备对其他主机进行欺骗网关型ARP欺骗：欺骗者主机冒充其他主机对网关设备进行欺骗主机网关一起骗图片来源网络你可以选择告诉小明，”嗨，我才是邮局，你把要送的信都送到这儿来吧！“，或者通知邮局：”邮局叔叔你好，我是小明，最近搬家了，把小明的信都送到这个地址吧！“或者两头瞒。万事俱备，就差程序员了之前专门为arp攻击写过一篇scapy的安装与使用的文章，这里有一切你需要掌握的用来干坏事的知识->click here! ↓DeepWeaver：通过摆弄python scapy模块 了解网络模型--Get your hands dirty!​zhuanlan.zhihu.com我们首先需要导入scapyfrom scapy.all import *